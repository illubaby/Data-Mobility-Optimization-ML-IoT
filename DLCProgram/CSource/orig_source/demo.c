#include "demo.h"

/* Fully-Connected Layer */
// Test FullyConnected2DFloat
// void FullyConnected2DFloat(
//     const float* input_data  , const int* input_dims,
//     const float* weights_data, const int* weights_dims, 
//     const float* bias_data   , const int* bias_dims,
//     float* output_data       , const int* output_dims,
//     float output_activation_min, float output_activation_max
// );
void testFullyConnected2DFloat() {
    // Test data
    int input_dims [1] = {5};
    int weight_dims[2] = {5, 6}; 
    int bias_dims  [1] = {6};
    int output_dims[1] = {6};

    float input_data[5] = {
        6.0, 1.3, 45, -5.6, 102
    };
    float weights_data[5 * 6] = {
        1.0, 2.0, 3.0, 4.0, 5.0,
        1.21, 2.1, 3.1, -4.1, 4.1,
        1.11, 2.2, -3.2, 4.2, 2.2,
        1.1, -2.3, 3.3, 4.23, 15.3,
        61.1, 2.4, 3.4, 4.4, 5.4,
        11.1, 2.5, 3.5, 4.5, 5.5
    };
    float bias_data[5] = {
        2, -3, 4, 55, -96
    };
    float output_data[6];

    FullyConnected2DFloat(
        input_data  , input_dims,
        weights_data, weight_dims,
        bias_data   , bias_dims,
        output_data , output_dims,
        -999999.9, 9999999.9
    );
    printf("Input Data: \n");
    printArray1DF(input_data, input_dims[0]);
    printf("Weight Data: \n");
    printArray2DF(weights_data, weight_dims);
    printf("Bias Data:\n");
    printArray1DF(bias_data, bias_dims[0]);
    printf("Output Data:\n");
    printArray1DF(output_data, output_dims[0]);
}

// Test FullyConnected2DInt
// void FullyConnected2DInt(
//     const int8_t* input_data , const int* input_dims, int32_t input_offset, 
//     const int8_t* filter_data, const int* filter_dims, int32_t filter_offset,
//     const int32_t* bias_data  , const int* bias_dims,
//     int8_t* output_data      , const int* output_dims,
//     int32_t output_offset, int32_t output_multiplier, int8_t output_shift, 
//     int32_t output_activation_min, int32_t output_activation_max
// ); 
void testFullyConnected2DInt() {

    // /* Test case * -- Bug */
    // int input_dims [1] = {18};
    // int filter_dims[2] = {18, 6}; 
    // int bias_dims  [1] = {6};
    // int output_dims[1] = {6};

    // int8_t input_data[18] = {
    //     1, 2, -3, -4, -5, -6, -7, -8, 90,
    //     20, 25, 42, 32, 12, 66, -128, 127, 34
    // };
    // int8_t filter_data[18 * 6] = {
    //     2, 3, 43, 56, 11, 22,
    //         2, 3, 43, 56, 11, 22,
    //             2, 3, 43, 56, 11, 22,
    //     4, 28, 74, 66, 43, 111,
    //         4, 28, 74, 66, 43, 111,
    //             4, 28, 74, 66, 43, 111,
    //     90, 42, 64, 19, 1, 2,
    //         90, 42, 64, 19, 1, 2,
    //             90, 42, 64, 19, 1, 2,
    //     98, 32, 17, 89, 1, -2,
    //         98, 32, 17, 89, 1, -2,
    //             98, 32, 17, 89, 1, -2,
    //     6, 23, 65, 76, 1, 2, 
    //         6, 23, 65, 76, 1, 2, 
    //             6, 23, 65, 76, 1, 2, 
    //     43, 4, -1, -89, 1, 2, 
    //         43, 4, -1, -89, 1, 2, 
    //             43, 4, -1, -89, 1, 2
    // };
    // int32_t bias_data[6] = {
    //     1, 43, 87, 119, 46, 67
    // };
    // int8_t output_data[6];
    // /******************/

    /* Test case 0 */
    int input_dims [1] = {27};
    int filter_dims[2] = {27, 9}; 
    int bias_dims  [1] = {9};
    int output_dims[1] = {9};

    int8_t input_data[27] = {
        1, 2, -3, -4, -5, -6, -7, -8, 90,
        20, 25, 42, 32, 12, 66, -128, 127, 34,
        11, 22, -33, 44, -55, 66, -77, 88, -99
    };
    int8_t filter_data[27 * 9] = {
        2, 3, 43, 56, 11, 22, -128, 79, 27,
            2, 3, 43, 56, 11, 22, -128, 79, 27,
                2, 3, 43, 56, 11, 22, -128, 79, 27,
        4, 28, 74, 66, 43, 111, -110, 19, 81,
            4, 28, 74, 66, 43, 111, -110, 19, 81,
                4, 28, 74, 66, 43, 111, -110, 19, 81,
        90, 42, 64, 19, 1, 2, 3, 4, 5,
            90, 42, 64, 19, 1, 2, 3, 4, 5,
                90, 42, 64, 19, 1, 2, 3, 4, 5,
        98, 32, 17, 89, 1, -2, 3, 4, 5,
            98, 32, 17, 89, 1, -2, 3, 4, 5,
                98, 32, 17, 89, 1, -2, 3, 4, 5,
        6, 23, 65, 76, 1, 2, -3, 4, 5,
            6, 23, 65, 76, 1, 2, -3, 4, 5,
                6, 23, 65, 76, 1, 2, -3, 4, 5,
        43, 4, -1, -89, 1, 2, 3, -4, 5,
            43, 4, -1, -89, 1, 2, 3, -4, 5,
                43, 4, -1, -89, 1, 2, 3, -4, 5,
        -30, 6, -45, 89, 1, 2, 3, 4, -5,
            -30, 6, -45, 89, 1, 2, 3, 4, -5,
                -30, 6, -45, 89, 1, 2, 3, 4, -5,
        43, 4, -1, -89, 1, 2, 3, -4, 5,
            43, 4, -1, -89, 1, 2, 3, -4, 5,
                43, 4, -1, -89, 1, 2, 3, -4, 5,
        -30, 6, -45, 89, 1, 2, 3, 4, -5,
            -30, 6, -45, 89, 1, 2, 3, 4, -5,
                -30, 6, -45, 89, 1, 2, 3, 4, -5,
    };
    int32_t bias_data[9] = {
        1, 43, 87, 119, 46, 67, 100, 23, -24
    };
    int8_t output_data[9];
    /******************/


    FullyConnected2DInt(
        input_data  , input_dims , 0,
        filter_data , filter_dims, 0,
        bias_data   , bias_dims, 
        output_data , output_dims,
        0, 1073742347, 7,
        0, 255
    );
    printf("Input Data: \n");
    printArray1DI(input_data, input_dims[0]);
    printf("Weight Data: \n");
    printArray2DI(filter_data, filter_dims);
    printf("Bias Data:\n");
    printArray1DI32(bias_data, bias_dims[0]);
    printf("Output Data:\n");
    printArray1DI(output_data, output_dims[0]);
    printf("Output Data (Hex Ver):\n");
    printArray1DIH(output_data, output_dims[0]);

    // Special Print
    // printf("*************\n");
    // printf("SOFTWARE RESULT\n");
    // int length = output_dims[0];
    // for (int i = 0; i < length; i = i + 4) {
    //     printf("%d %d %d %d\n",
    //         output_data[i], 
    //         (i + 1 < length) ? output_data[i + 1] : 0,
    //         (i + 2 < length) ? output_data[i + 2] : 0,
    //         (i + 3 < length) ? output_data[i + 3] : 0
    //     );
    // }
    // printf("*************\n");
}

/* Convolutional Layer */
// void Conv3DFloat( 
//     const float* input_data , const int* input_dims,
//     const float* filter_data, const int* filter_dims,
//     const float* bias_data  , const int* bias_dims,
//     int stride_width, int stride_height, 
//     int pad_width   , int pad_height, 
//     float* output_data      , const int* output_dims,
//     float output_activation_min, float output_activation_max
// );
void testConv3DFloat() {
    int input_dims[] = {6, 6, 3};
    int filter_dims[] = {3, 3, 3, 4};
    int bias_dims[] = {4};
    int stride_width = 1;
    int stride_height = 1;
    int output_dims[] = {4, 4, 4};

    float input_data[6 * 6 * 3] = {
        /* z = 0 */
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.2, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.5, 2.0, 3.0, 1.5, 6.7, 8.9,
        1.0, 3.0, 9.0, 4.5, 6.7, 8.9,
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
        /* z = 1 */
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
        41.2, 2.0, 3.0, 4.5, 6.7, 8.9,
        12.5, 2.0, 3.0, 1.5, 6.7, 8.9,
        1.10, 3.0, 9.0, 4.5, 6.7, 8.9,
        1.20, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
        /* z = 2 */
        1.10, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.42, 2.0, 3.0, 4.5, 6.7, 8.9,
        1.55, 2.0, 3.0, 1.5, 6.7, 8.9,
        1.0, 3.0, 9.0, 4.5, 6.7, 8.9,
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9, 
        1.0, 2.0, 3.0, 4.5, 6.7, 8.9,
    };
    float filter_data[3 * 3 * 3 * 4] = {
    /* Channel = 0 */
        /* z = 0 */
        1.1, 1.1, 0,
        1.1, 0, 1.1,
        1.1, 1.1, 0,
        /* z = 1 */
        1.1, 1.1, 0,
        1.1, 1.1, 0,
        1.1, 0, 1.1,
        /* z = 2 */
        1.1, 0, 1.1,
        1.1, 1.1, 0,
        1.1, 1.1, 0,
    /* Channel = 1 */
        /* z = 0 */
        1.1, 2.1, 0,
        2.1, 0, 1.1,
        2.1, 1.1, 0,
        /* z = 1 */
        2.1, 1.1, 0,
        2.1, 1.1, 0,
        2.1, 0, 1.1,
        /* z = 2 */
        2.1, 0, 1.1,
        2.1, 1.1, 0,
        2.1, 1.1, 0,
    /* Channel = 2 */
        /* z = 0 */
        1.1, 3.1, 0,
        1.1, 0, 1.1,
        1.1, 3.1, 0,
        /* z = 1 */
        1.1, 3.1, 0,
        1.1, 3.1, 0,
        1.1, 0, 1.1,
        /* z = 2 */
        1.1, 0, 1.1,
        1.1, 3.1, 0,
        1.1, 3.1, 0,
    /* Channel = 3 */
        /* z = 0 */
        1.1, 1.1, 0,
        1.1, 0, 4.1,
        2.1, 1.1, 0,
        /* z = 1 */
        2.1, 1.1, 0,
        1.1, 4.1, 0,
        1.1, 0, 1.1,
        /* z = 2 */
        1.1, 0, 4.1,
        1.1, 2.1, 0,
        1.1, 1.1, 0
    };
    float bias_data[4] = {
        2.0, 3.1, 4.2, 5.4
    };
    float output_data[4 * 4 * 4];

    Conv3DFloat(
        input_data, input_dims,
        filter_data, filter_dims,
        bias_data, bias_dims, 
        stride_width, stride_height,
        0, 0,
        output_data, output_dims,
        0, 99999999.0
    );

    printf("Input Data: \n");
    printArray3DF(input_data, input_dims);
    printf("Filter Data: \n");
    printArray4DF(filter_data, filter_dims);
    printf("Bias Data:\n");
    printArray1DF(bias_data, bias_dims[0]);
    printf("Output Data:\n");
    printArray3DF(output_data, output_dims);
}

// void Conv3DInt(
//     const int8_t* input_data , const int* input_dims , int32_t input_offset,
//     const int8_t* filter_data, const int* filter_dims, int32_t filter_offset,
//     const int32_t* bias_data  , const int* bias_dims, 
//     int stride_width, int stride_height, 
//     int pad_width   , int pad_height, 
//     int8_t* output_data      , const int* output_dims,
//     int32_t output_offset, int32_t output_multiplier, int8_t output_shift, 
//     int32_t output_activation_min, int32_t output_activation_max
// );
void testConv3DInt() {
    // /* Test Case 0 */
    // int input_dims[]  = {7, 7, 3};
    // int filter_dims[] = {3, 3, 3, 6};
    // int bias_dims[]   = {6};
    // int stride_width  = 1;
    // int stride_height = 1;
    // int output_dims[] = {5, 5, 6};

    // int8_t input_data[7 * 7 * 3] = {
    // /* z = 0 */
    //     1, 2, 7, 8, -1, -78, 12, 
    //     5, 45, 64, 123, -89, -74, 12, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     1, 2, 7, 8, -1, 0, -19, 
    //     5, 45, 64, 123, -34, -20, 75, 
    //     7, 45, 123, 45, 90, 101, 96, 
    //     15, 16, 17, 18, 19, 20, 21, 
    // /* z = 1 */
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     51, 45, 64, 123, 34, -20, 10, 
    //     57, 45, 123, 45, 90, 101, 21, 
    //     110, 2, 7, 8, -55, -11, 22, 
    //     51, 45, 64, 23, -24, 20, 88, 
    //     71, 45, -23, 45, 90, 101, 66, 
    //     15, 16, 17, 18, 19, 20, 21, 
    // /* z = 2 */
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29
    // };
    // int8_t filter_data[3 * 3 * 3 * 6] = {
    // /* Channel = 0 */
    //     /* z = 0 */
    //     10, 11, 0,
    //     10, 0, 11,
    //     11, 11, 0,
    //     /* z = 1 */
    //     11, 11, 0,
    //     11, 11, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 11, 0,
    //     11, 11, 0,
    // /* Channel = 1 */
    //     /* z = 0 */
    //     11, 21, 0,
    //     21, 0, 11,
    //     21, 11, 0,
    //     /* z = 1 */
    //     21, 11, 0,
    //     21, 11, 0,
    //     21, 0, 11,
    //     /* z = 2 */
    //     21, 0, 11,
    //     21, 11, 0,
    //     21, 11, 0,
    // /* Channel = 2 */
    //     /* z = 0 */
    //     11, 31, 0,
    //     11, 0, 11,
    //     11, 31, 0,
    //     /* z = 1 */
    //     11, 31, 0,
    //     11, 31, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 31, 0,
    //     11, 31, 0,
    // /* Channel = 3 */
    //     /* z = 0 */
    //     11, 11, 40,
    //     11, 40, 41,
    //     21, 11, 40,
    //     /* z = 1 */
    //     21, 11, 40,
    //     11, 41, 40,
    //     11, 40, 11,
    //     /* z = 2 */
    //     11, 40, 41,
    //     11, 21, 40,
    //     11, 11, 40,
    // /* Channel = 4 */
    //     /* z = 0 */
    //     11, 11, 30,
    //     11, 30, 41,
    //     21, 11, 30,
    //     /* z = 1 */
    //     21, 11, 30,
    //     11, 41, 30,
    //     11, 30, 11,
    //     /* z = 2 */
    //     11, 0, 41,
    //     11, 21, 30,
    //     11, 11, 30,
    // /* Channel = 5 */
    //     /* z = 0 */
    //     11, 11, 0,
    //     11, -20, 41,
    //     21, 11, 20,
    //     /* z = 1 */
    //     21, 11, 10,
    //     11, 41, 10,
    //     11, 10, 11,
    //     /* z = 2 */
    //     11, 10, 21,
    //     11, 21, 10,
    //     11, 11, 10
    // };
    // int32_t bias_data[6] = {
    //     20, 31, 42, 54, -15, 67
    // };
    // int8_t output_data[5 * 5 * 6];
    // /******************/

    // /* Test Case 1 */
    // int input_dims[]  = {7, 7, 6};
    // int filter_dims[] = {3, 3, 6, 6};
    // int bias_dims[]   = {6};
    // int stride_width  = 1;
    // int stride_height = 1;
    // int output_dims[] = {5, 5, 6};

    // int8_t input_data[7 * 7 * 6] = {
    //     /* z = 0 */
    //     1, 2, 7, 8, -1, -78, 12, 
    //     5, 45, 64, 123, -89, -74, 12, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     1, 2, 7, 8, -1, 0, -19, 
    //     5, 45, 64, 123, -34, -20, 75, 
    //     7, 45, 123, 45, 90, 101, 96, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     /* z = 1 */
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     51, 45, 64, 123, 34, -20, 10, 
    //     57, 45, 123, 45, 90, 101, 21, 
    //     110, 2, 7, 8, -55, -11, 22, 
    //     51, 45, 64, 23, -24, 20, 88, 
    //     71, 45, -23, 45, 90, 101, 66, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     /* z = 2 */
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29,
    //     /* z = 3*/
    //     23, 34, 56, 12, 14, -17, -19,
    //     20, 21, 127, -128, 110, 103, 19,
    //     1, 1, 1, 2, 2, 2, 3,
    //     45, 54, 46, 64, 75, 74, 10,
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     /* z = 4*/
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29,
    //     1, 1, 1, 2, 2, 2, 3,
    //     45, 54, 46, 64, 75, 74, 10,
    //     1, 23, 7, 8, 55, 21, 10, 
    //     1, 23, 7, 8, 55, 21, 10, 
    //     /* z = 5*/
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     20, 21, 127, -128, 110, 103, 19,
    //     23, 34, 56, 12, 14, -17, -19
    // };
    // int8_t filter_data[3 * 3 * 6 * 6] = {
    // /* Channel = 0 */
    //     /* z = 0 */
    //     10, 11, 0,
    //     10, 0, 11,
    //     11, 11, 0,
    //     /* z = 1 */
    //     11, 11, 0,
    //     11, 11, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 11, 0,
    //     11, 11, 0,
    //     /* z = 3*/
    //     22, 33, 44, 
    //     55, 66, 77, 
    //     88, 99, 110,
    //     /* z = 4*/
    //     22, 0, 22,
    //     33, 22, 33,
    //     44, 33, 22,
    //     /* z = 5*/
    //     -1, -2, -3,
    //     -11, -12, -13,
    //     -14, -15, -16,
    // /* Channel = 1 */
    //     /* z = 0 */
    //     11, 21, 0,
    //     21, 0, 11,
    //     21, 11, 0,
    //     /* z = 1 */
    //     21, 11, 0,
    //     21, 11, 0,
    //     21, 0, 11,
    //     /* z = 2 */
    //     21, 0, 11,
    //     21, 11, 0,
    //     21, 11, 0,
    //     /* z = 3*/
    //     5, 10, 15,
    //     20, 25, 30, 
    //     35, 40, 45,
    //     /* z = 4*/
    //     60, 70, 80,
    //     80, 70, 60,
    //     70, 80, 60,
    //     /* z = 5*/
    //     11, 22, 33, 
    //     44, 55, 66,
    //     77, 88, 99,
    // /* Channel = 2 */
    //     /* z = 0 */
    //     11, 31, 0,
    //     11, 0, 11,
    //     11, 31, 0,
    //     /* z = 1 */
    //     11, 31, 0,
    //     11, 31, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 31, 0,
    //     11, 31, 0,
    //     /* z = 3*/
    //     -5, 10, 15,
    //     20, -25, 30, 
    //     35, 40, -45,
    //     /* z = 4*/
    //     -60, 70, 80,
    //     80, -70, 60,
    //     70, 80, -60,
    //     /* z = 5*/
    //     -11, 22, 33, 
    //     44, -55, 66,
    //     77, 88, -99,
    // /* Channel = 3 */
    //     /* z = 0 */
    //     11, 11, 40,
    //     11, 40, 41,
    //     21, 11, 40,
    //     /* z = 1 */
    //     21, 11, 40,
    //     11, 41, 40,
    //     11, 40, 11,
    //     /* z = 2 */
    //     11, 40, 41,
    //     11, 21, 40,
    //     11, 11, 40,
    //     /* z = 3*/
    //     -5, 10, 15,
    //     -20, 25, 30, 
    //     -35, 40, 45,
    //     /* z = 4*/
    //     -60, 70, 80,
    //     -80, 70, 60,
    //     -70, 80, 60,
    //     /* z = 5*/
    //     -11, 22, 33, 
    //     -44, 55, 66,
    //     -77, 88, 99,
    // /* Channel = 4 */
    //     /* z = 0 */
    //     11, 11, 30,
    //     11, 30, 41,
    //     21, 11, 30,
    //     /* z = 1 */
    //     21, 11, 30,
    //     11, 41, 30,
    //     11, 30, 11,
    //     /* z = 2 */
    //     11, 0, 41,
    //     11, 21, 30,
    //     11, 11, 30,
    //     /* z = 3*/
    //     5, -10, 15,
    //     20, -25, 30, 
    //     35, -40, 45,
    //     /* z = 4*/
    //     60, -70, 80,
    //     80, -70, 60,
    //     70, -80, 60,
    //     /* z = 5*/
    //     11, -22, 33, 
    //     44, -55, 66,
    //     77, -88, 99,
    // /* Channel = 5 */
    //     /* z = 0 */
    //     11, 11, 0,
    //     11, -20, 41,
    //     21, 11, 20,
    //     /* z = 1 */
    //     21, 11, 10,
    //     11, 41, 10,
    //     11, 10, 11,
    //     /* z = 2 */
    //     11, 10, 21,
    //     11, 21, 10,
    //     11, 11, 10,
    //     /* z = 3*/
    //     5, 10, -15,
    //     20, -25, 30, 
    //     -35, 40, 45,
    //     /* z = 4*/
    //     60, 70, -80,
    //     80, -70, 60,
    //     -70, 80, 60,
    //     /* z = 5*/
    //     11, 22, -33, 
    //     44, -55, 66,
    //     -77, 88, 99
    // };
    // int32_t bias_data[6] = {
    //     20, 31, 42, 54, -15, 67
    // };
    // int8_t output_data[5 * 5 * 6];
    /******************/

    // /* Test Case 2 */
    // int input_dims[]  = {7, 7, 9};
    // int filter_dims[] = {3, 3, 9, 9};
    // int bias_dims[]   = {9};
    // int stride_width  = 1;
    // int stride_height = 1;
    // int output_dims[] = {5, 5, 9};

    // int8_t input_data[7 * 7 * 9] = {
    //     /* z = 0 */
    //         1, 2, 7, 8, -1, -78, 12,
    //         5, 45, 64, 123, -89, -74, 12,
    //         7, 45, 123, 45, 90, 101, 87,
    //         1, 2, 7, 8, -1, 0, -19,
    //         5, 45, 64, 123, -34, -20, 75,
    //         7, 45, 123, 45, 90, 101, 96,
    //         15, 16, 17, 18, 19, 20, 21,
    //     /* z = 1 */
    //         -90, 2, 7, 8, -55, -21, 10,
    //         51, 45, 64, 123, 34, -20, 10,
    //         57, 45, 123, 45, 90, 101, 21,
    //         110, 2, 7, 8, -55, -11, 22,
    //         51, 45, 64, 23, -24, 20, 88,
    //         71, 45, -23, 45, 90, 101, 66,
    //         15, 16, 17, 18, 19, 20, 21,
    //     /* z = 2 */
    //         1, 23, 7, 8, 55, 21, 10,
    //         5, 4, 64, 123, 34, 20, 21,
    //         7, 5, 123, 45, 90, 101, 21,
    //         1, 2, 7, 8, 55, -1, 18,
    //         5, 5, 64, 13, 34, 20, 21,
    //         15, 16, 17, 18, 19, 20, 21,
    //         23, 24, 25, 26, 27, 28, 29,
    //     /* z = 3*/
    //         23, 34, 56, 12, 14, -17, -19,
    //         20, 21, 127, -128, 110, 103, 19,
    //         1, 1, 1, 2, 2, 2, 3,
    //         45, 54, 46, 64, 75, 74, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //         5, 4, 64, 123, 34, 20, 21,
    //         7, 5, 123, 45, 90, 101, 21,
    //     /* z = 4*/
    //         5, 5, 64, 13, 34, 20, 21,
    //         15, 16, 17, 18, 19, 20, 21,
    //         23, 24, 25, 26, 27, 28, 29,
    //         1, 1, 1, 2, 2, 2, 3,
    //         45, 54, 46, 64, 75, 74, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //     /* z = 5*/
    //         -90, 2, 7, 8, -55, -21, 10,
    //         -90, 2, 7, 8, -55, -21, 10,
    //         -90, 2, 7, 8, -55, -21, 10,
    //         1, 2, 7, 8, 55, -1, 18,
    //         7, 45, 123, 45, 90, 101, 87,
    //         20, 21, 127, -128, 110, 103, 19,
    //         23, 34, 56, 12, 14, -17, -19,
    //     /* z = 6*/
    //         23, 34, 56, 12, 14, -17, -19,
    //         20, 21, 127, -128, 110, 103, 19,
    //         1, 1, 1, 2, 2, 2, 3,
    //         45, 54, 46, 64, 75, 74, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //         5, 4, 64, 123, 34, 20, 21,
    //         7, 5, 123, 45, 90, 101, 21,
    //     /* z = 7*/
    //         5, 5, 64, 13, 34, 20, 21,
    //         15, 16, 17, 18, 19, 20, 21,
    //         23, 24, 25, 26, 27, 28, 29,
    //         1, 1, 1, 2, 2, 2, 3,
    //         45, 54, 46, 64, 75, 74, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //         1, 23, 7, 8, 55, 21, 10,
    //     /* z = 8*/
    //         -90, 2, 7, 8, -55, -21, 10,
    //         -90, 2, 7, 8, -55, -21, 10,
    //         -90, 2, 7, 8, -55, -21, 10,
    //         1, 2, 7, 8, 55, -1, 18, 
    //         7, 45, 123, 45, 90, 101, 87,
    //         20, 21, 127, -128, 110, 103, 19,
    //         23, 34, 56, 12, 14, -17, -19
    // };
    // int8_t filter_data[3 * 3 * 9 * 9] = {
    // /* Channel = 0 */
    //     /* z = 0 */
    //         10, 11, 0,
    //         10, 0, 11,
    //         11, 11, 0,
    //     /* z = 1 */
    //         11, 11, 0,
    //         11, 11, 0,
    //         11, 0, 11,
    //     /* z = 2 */
    //         11, 0, 11,
    //         11, 11, 0,
    //         11, 11, 0,
    //     /* z = 3 */
    //         22, 33, 44,
    //         55, 66, 77,
    //         88, 99, 110,
    //     /* z = 4 */
    //         22, 0, 22,
    //         33, 22, 33,
    //         44, 33, 22,
    //     /* z = 5 */
    //         -1, -2, -3,
    //         -11, -12, -13,
    //         -14, -15, -16,
    //     /* z = 6 */
    //         11, 11, 0,
    //         11, 11, 0,
    //         11, 0, 11,
    //     /* z = 7 */
    //         11, 0, 11,
    //         11, 11, 0,
    //         11, 11, 0,
    //     /* z = 8 */
    //         22, 33, 44,
    //         55, 66, 77,
    //         88, 99, 110,
    // /* Channel = 1 */
    //     /* z = 0 */
    //         11, 21, 0,
    //         21, 0, 11,
    //         21, 11, 0,
    //     /* z = 1 */
    //         21, 11, 0,
    //         21, 11, 0,
    //         21, 0, 11,
    //     /* z = 2 */
    //         21, 0, 11,
    //         21, 11, 0,
    //         21, 11, 0,
    //     /* z = 3 */
    //         5, 10, 15,
    //         20, 25, 30,
    //         35, 40, 45,
    //     /* z = 4 */
    //         60, 70, 80,
    //         80, 70, 60,
    //         70, 80, 60,
    //     /* z = 5 */
    //         11, 22, 33,
    //         44, 55, 66,
    //         77, 88, 99,
    //     /* z = 6 */
    //         11, 11, 0,
    //         11, 11, 0,
    //         11, 0, 11,
    //     /* z = 7 */
    //         11, 0, 11,
    //         11, 11, 0,
    //         11, 11, 0,
    //     /* z = 8 */
    //         22, 33, 44,
    //         55, 66, 77,
    //         88, 99, 110,
    // /* Channel = 2 */
    //     /* z = 0 */
    //         11, 31, 0,
    //         11, 0, 11,
    //         11, 31, 0,
    //     /* z = 1 */
    //         11, 31, 0,
    //         11, 31, 0,
    //         11, 0, 11,
    //     /* z = 2 */
    //         11, 0, 11,
    //         11, 31, 0,
    //         11, 31, 0,
    //     /* z = 3 */
    //         -5, 10, 15,
    //         20, -25, 30,
    //         35, 40, -45,
    //     /* z = 4 */
    //         -60, 70, 80,
    //         80, -70, 60,
    //         70, 80, -60,
    //     /* z = 5 */
    //         -11, 22, 33,
    //         44, -55, 66,
    //         77, 88, -99,
    //     /* z = 6 */
    //         11, 31, 0,
    //         11, 0, 11,
    //         11, 31, 0,
    //     /* z = 7 */
    //         11, 31, 0,
    //         11, 31, 0,
    //         11, 0, 11,
    //     /* z = 8 */
    //         11, 0, 11,
    //         11, 31, 0,
    //         11, 31, 0,
    // /* Channel = 3 */
    //     /* z = 0 */
    //         11, 11, 40,
    //         11, 40, 41,
    //         21, 11, 40,
    //     /* z = 1 */
    //         21, 11, 40,
    //         11, 41, 40,
    //         11, 40, 11,
    //     /* z = 2 */
    //         11, 40, 41,
    //         11, 21, 40,
    //         11, 11, 40,
    //     /* z = 3*/
    //         -5, 10, 15,
    //         -20, 25, 30,
    //         -35, 40, 45,
    //     /* z = 4*/
    //         -60, 70, 80,
    //         -80, 70, 60,
    //         -70, 80, 60,
    //     /* z = 5*/
    //         -11, 22, 33,
    //         -44, 55, 66,
    //         -77, 88, 99,
    //     /* z = 6 */
    //         11, 11, 0,
    //         11, 11, 0,
    //         11, 0, 11,
    //     /* z = 7 */
    //         11, 31, 0,
    //         11, 31, 0,
    //         11, 0, 11,
    //     /* z = 8 */
    //         11, 0, 11,
    //         11, 31, 0,
    //         11, 31, 0,
    // /* Channel = 4 */
    //     /* z = 0 */
    //         11, 11, 30,
    //         11, 30, 41,
    //         21, 11, 30,
    //     /* z = 1 */
    //         21, 11, 30,
    //         11, 41, 30,
    //         11, 30, 11,
    //     /* z = 2 */
    //         11, 0, 41,
    //         11, 21, 30,
    //         11, 11, 30,
    //     /* z = 3*/
    //         5, -10, 15,
    //         20, -25, 30,
    //         35, -40, 45,
    //     /* z = 4*/
    //         60, -70, 80,
    //         80, -70, 60,
    //         70, -80, 60,
    //     /* z = 5*/
    //         11, -22, 33,
    //         44, -55, 66,
    //         77, -88, 99,
    //     /* z = 6 */
    //         11, 11, 0,
    //         11, 11, 0,
    //         11, 0, 11,
    //     /* z = 7 */
    //         11, 31, 0,
    //         11, 31, 0,
    //         11, 0, 11,
    //     /* z = 8 */
    //         11, 0, 11,
    //         11, 31, 0,
    //         11, 31, 0,
    // /* Channel = 5 */
    //     /* z = 0 */
    //         11, 11, 0,
    //         11, -20, 41,
    //         21, 11, 20,
    //     /* z = 1 */
    //         21, 11, 10,
    //         11, 41, 10,
    //         11, 10, 11,
    //     /* z = 2 */
    //         11, 10, 21,
    //         11, 21, 10,
    //         11, 11, 10,
    //     /* z = 3 */
    //         5, 10, -15,
    //         20, -25, 30,
    //         -35, 40, 45,
    //     /* z = 4 */
    //         60, 70, -80,
    //         80, -70, 60,
    //         -70, 80, 60,
    //     /* z = 5 */
    //         11, 22, -33,
    //         44, -55, 66,
    //         -77, 88, 99,
    //     /* z = 6 */
    //         -5, 10, 15,
    //         -20, 25, 30,
    //         -35, 40, 45,
    //     /* z = 7 */
    //         -60, 70, 80,
    //         -80, 70, 60,
    //         -70, 80, 60,
    //     /* z = 8 */
    //         -11, 22, 33,
    //         -44, 55, 66,
    //         -77, 88, 99,
    // /* Channel = 6 */
    //     /* z = 0 */
    //         1, 2, 3,
    //         4, 5, 6,
    //         7, 8, 9,
    //     /* z = 1 */
    //         -1, 2, 3,
    //         -4, 5, 6,
    //         -7, 8, 9,
    //     /* z = 2 */
    //         1, -2, 3,
    //         4, -5, 6,
    //         7, -8, 9,
    //     /* z = 3 */
    //         1, 2, -3,
    //         4, 5, -6,
    //         7, 8, -9,
    //     /* z = 4 */
    //         -1, -2, -3,
    //         4, 5, 6,
    //         7, 8, 9,
    //     /* z = 5 */
    //         1, 2, 3,
    //         -4, -5, -6,
    //         7, 8, 9,
    //     /* z = 6 */
    //         1, 2, 3,
    //         4, 5, 6,
    //         -7, -8, -9,
    //     /* z = 7 */
    //         -1, 2, 3,
    //         4, -5, 6,
    //         7, 8, -9,
    //     /* z = 8 */
    //         1, 2, -3,
    //         4, -5, 6,
    //         -7, 8, 9,
    // /* Channel = 7 */
    //     /* z = 0 */
    //         1, 2, 30,
    //         4, 5, 6,
    //         7, 8, 9,
    //     /* z = 1 */
    //         -1, 2, 3,
    //         -4, 5, 6,
    //         -7, 8, 90,
    //     /* z = 2 */
    //         1, -2, 3,
    //         40, -5, 6,
    //         7, -8, 9,
    //     /* z = 3 */
    //         1, 20, -3,
    //         4, 5, -6,
    //         7, 8, -9,
    //     /* z = 4 */
    //         -1, -2, -3,
    //         40, 5, 6,
    //         7, 8, 90,
    //     /* z = 5 */
    //         1, 2, 3,
    //         -4, -5, -6,
    //         7, 8, 9,
    //     /* z = 6 */
    //         1, 20, 3,
    //         4, 5, 60,
    //         -7, -8, -9,
    //     /* z = 7 */
    //         -1, 2, 3,
    //         4, -5, 60,
    //         7, 8, -9,
    //     /* z = 8 */
    //         10, 2, -3,
    //         4, -5, 6,
    //         -7, 8, 9,
    // /* Channel = 8 */
    //     /* z = 0 */
    //         1, 2, 3,
    //         4, 5, 6,
    //         7, 8, 9,
    //     /* z = 1 */
    //         -1, 2, 3,
    //         -4, 50, 6,
    //         -7, 8, 9,
    //     /* z = 2 */
    //         1, -2, 3,
    //         40, -5, 6,
    //         7, -8, 9,
    //     /* z = 3 */
    //         1, 2, -3,
    //         4, 5, -6,
    //         7, 8, -9,
    //     /* z = 4 */
    //         -1, -2, -3,
    //         4, 50, 6,
    //         7, 8, 9,
    //     /* z = 5 */
    //         1, 20, 3,
    //         -4, -5, -6,
    //         7, 80, 9,
    //     /* z = 6 */
    //         1, 20, 3,
    //         4, 5, 6,
    //         -7, -8, -90,
    //     /* z = 7 */
    //         -10, 2, 3,
    //         4, -50, 6,
    //         7, 8, -9,
    //     /* z = 8 */
    //         10, 2, -3,
    //         40, -5, 60,
    //         -70, 80, 90
    // };
    // int32_t bias_data[9] = {
    //     20, 31, 42, 54, -15, 67, 34, 35, 78
    // };
    // int8_t output_data[5 * 5 * 9];
    /******************/

    // /* Test Case 4 */
    // int input_dims[]  = {7, 7, 3};
    // int filter_dims[] = {3, 3, 3, 6};
    // int bias_dims[]   = {6};
    // int stride_width  = 2;
    // int stride_height = 2;
    // int output_dims[] = {3, 3, 6};

    // int8_t input_data[7 * 7 * 3] = {
    // /* z = 0 */
    //     1, 2, 7, 8, -1, -78, 12, 
    //     5, 45, 64, 123, -89, -74, 12, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     1, 2, 7, 8, -1, 0, -19, 
    //     5, 45, 64, 123, -34, -20, 75, 
    //     7, 45, 123, 45, 90, 101, 96, 
    //     15, 16, 17, 18, 19, 20, 21, 
    // /* z = 1 */
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     51, 45, 64, 123, 34, -20, 10, 
    //     57, 45, 123, 45, 90, 101, 21, 
    //     110, 2, 7, 8, -55, -11, 22, 
    //     51, 45, 64, 23, -24, 20, 88, 
    //     71, 45, -23, 45, 90, 101, 66, 
    //     15, 16, 17, 18, 19, 20, 21, 
    // /* z = 2 */
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29
    // };
    // int8_t filter_data[3 * 3 * 3 * 6] = {
    // /* Channel = 0 */
    //     /* z = 0 */
    //     10, 11, 0,
    //     10, 0, 11,
    //     11, 11, 0,
    //     /* z = 1 */
    //     11, 11, 0,
    //     11, 11, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 11, 0,
    //     11, 11, 0,
    // /* Channel = 1 */
    //     /* z = 0 */
    //     11, 21, 0,
    //     21, 0, 11,
    //     21, 11, 0,
    //     /* z = 1 */
    //     21, 11, 0,
    //     21, 11, 0,
    //     21, 0, 11,
    //     /* z = 2 */
    //     21, 0, 11,
    //     21, 11, 0,
    //     21, 11, 0,
    // /* Channel = 2 */
    //     /* z = 0 */
    //     11, 31, 0,
    //     11, 0, 11,
    //     11, 31, 0,
    //     /* z = 1 */
    //     11, 31, 0,
    //     11, 31, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 31, 0,
    //     11, 31, 0,
    // /* Channel = 3 */
    //     /* z = 0 */
    //     11, 11, 40,
    //     11, 40, 41,
    //     21, 11, 40,
    //     /* z = 1 */
    //     21, 11, 40,
    //     11, 41, 40,
    //     11, 40, 11,
    //     /* z = 2 */
    //     11, 40, 41,
    //     11, 21, 40,
    //     11, 11, 40,
    // /* Channel = 4 */
    //     /* z = 0 */
    //     11, 11, 30,
    //     11, 30, 41,
    //     21, 11, 30,
    //     /* z = 1 */
    //     21, 11, 30,
    //     11, 41, 30,
    //     11, 30, 11,
    //     /* z = 2 */
    //     11, 0, 41,
    //     11, 21, 30,
    //     11, 11, 30,
    // /* Channel = 5 */
    //     /* z = 0 */
    //     11, 11, 0,
    //     11, -20, 41,
    //     21, 11, 20,
    //     /* z = 1 */
    //     21, 11, 10,
    //     11, 41, 10,
    //     11, 10, 11,
    //     /* z = 2 */
    //     11, 10, 21,
    //     11, 21, 10,
    //     11, 11, 10
    // };
    // int32_t bias_data[6] = {
    //     20, 31, 42, 54, -15, 67
    // };
    // int8_t output_data[3 * 3 * 6];
    /******************/

    // /* Test Case 5 */
    // int input_dims[]  = {7, 7, 6};
    // int filter_dims[] = {3, 3, 6, 6};
    // int bias_dims[]   = {6};
    // int stride_width  =  2;
    // int stride_height =  2;
    // int output_dims[] = {3, 3, 6};

    // int8_t input_data[7 * 7 * 6] = {
    //     /* z = 0 */
    //     1, 2, 7, 8, -1, -78, 12, 
    //     5, 45, 64, 123, -89, -74, 12, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     1, 2, 7, 8, -1, 0, -19, 
    //     5, 45, 64, 123, -34, -20, 75, 
    //     7, 45, 123, 45, 90, 101, 96, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     /* z = 1 */
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     51, 45, 64, 123, 34, -20, 10, 
    //     57, 45, 123, 45, 90, 101, 21, 
    //     110, 2, 7, 8, -55, -11, 22, 
    //     51, 45, 64, 23, -24, 20, 88, 
    //     71, 45, -23, 45, 90, 101, 66, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     /* z = 2 */
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29,
    //     /* z = 3*/
    //     23, 34, 56, 12, 14, -17, -19,
    //     20, 21, 127, -128, 110, 103, 19,
    //     1, 1, 1, 2, 2, 2, 3,
    //     45, 54, 46, 64, 75, 74, 10,
    //     1, 23, 7, 8, 55, 21, 10, 
    //     5, 4, 64, 123, 34, 20, 21, 
    //     7, 5, 123, 45, 90, 101, 21, 
    //     /* z = 4*/
    //     5, 5, 64, 13, 34, 20, 21, 
    //     15, 16, 17, 18, 19, 20, 21, 
    //     23, 24, 25, 26, 27, 28, 29,
    //     1, 1, 1, 2, 2, 2, 3,
    //     45, 54, 46, 64, 75, 74, 10,
    //     1, 23, 7, 8, 55, 21, 10, 
    //     1, 23, 7, 8, 55, 21, 10, 
    //     /* z = 5*/
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     -90, 2, 7, 8, -55, -21, 10, 
    //     1, 2, 7, 8, 55, -1, 18, 
    //     7, 45, 123, 45, 90, 101, 87, 
    //     20, 21, 127, -128, 110, 103, 19,
    //     23, 34, 56, 12, 14, -17, -19
    // };
    // int8_t filter_data[3 * 3 * 6 * 6] = {
    // /* Channel = 0 */
    //     /* z = 0 */
    //     10, 11, 0,
    //     10, 0, 11,
    //     11, 11, 0,
    //     /* z = 1 */
    //     11, 11, 0,
    //     11, 11, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 11, 0,
    //     11, 11, 0,
    //     /* z = 3*/
    //     22, 33, 44, 
    //     55, 66, 77, 
    //     88, 99, 110,
    //     /* z = 4*/
    //     22, 0, 22,
    //     33, 22, 33,
    //     44, 33, 22,
    //     /* z = 5*/
    //     -1, -2, -3,
    //     -11, -12, -13,
    //     -14, -15, -16,
    // /* Channel = 1 */
    //     /* z = 0 */
    //     11, 21, 0,
    //     21, 0, 11,
    //     21, 11, 0,
    //     /* z = 1 */
    //     21, 11, 0,
    //     21, 11, 0,
    //     21, 0, 11,
    //     /* z = 2 */
    //     21, 0, 11,
    //     21, 11, 0,
    //     21, 11, 0,
    //     /* z = 3*/
    //     5, 10, 15,
    //     20, 25, 30, 
    //     35, 40, 45,
    //     /* z = 4*/
    //     60, 70, 80,
    //     80, 70, 60,
    //     70, 80, 60,
    //     /* z = 5*/
    //     11, 22, 33, 
    //     44, 55, 66,
    //     77, 88, 99,
    // /* Channel = 2 */
    //     /* z = 0 */
    //     11, 31, 0,
    //     11, 0, 11,
    //     11, 31, 0,
    //     /* z = 1 */
    //     11, 31, 0,
    //     11, 31, 0,
    //     11, 0, 11,
    //     /* z = 2 */
    //     11, 0, 11,
    //     11, 31, 0,
    //     11, 31, 0,
    //     /* z = 3*/
    //     -5, 10, 15,
    //     20, -25, 30, 
    //     35, 40, -45,
    //     /* z = 4*/
    //     -60, 70, 80,
    //     80, -70, 60,
    //     70, 80, -60,
    //     /* z = 5*/
    //     -11, 22, 33, 
    //     44, -55, 66,
    //     77, 88, -99,
    // /* Channel = 3 */
    //     /* z = 0 */
    //     11, 11, 40,
    //     11, 40, 41,
    //     21, 11, 40,
    //     /* z = 1 */
    //     21, 11, 40,
    //     11, 41, 40,
    //     11, 40, 11,
    //     /* z = 2 */
    //     11, 40, 41,
    //     11, 21, 40,
    //     11, 11, 40,
    //     /* z = 3*/
    //     -5, 10, 15,
    //     -20, 25, 30, 
    //     -35, 40, 45,
    //     /* z = 4*/
    //     -60, 70, 80,
    //     -80, 70, 60,
    //     -70, 80, 60,
    //     /* z = 5*/
    //     -11, 22, 33, 
    //     -44, 55, 66,
    //     -77, 88, 99,
    // /* Channel = 4 */
    //     /* z = 0 */
    //     11, 11, 30,
    //     11, 30, 41,
    //     21, 11, 30,
    //     /* z = 1 */
    //     21, 11, 30,
    //     11, 41, 30,
    //     11, 30, 11,
    //     /* z = 2 */
    //     11, 0, 41,
    //     11, 21, 30,
    //     11, 11, 30,
    //     /* z = 3*/
    //     5, -10, 15,
    //     20, -25, 30, 
    //     35, -40, 45,
    //     /* z = 4*/
    //     60, -70, 80,
    //     80, -70, 60,
    //     70, -80, 60,
    //     /* z = 5*/
    //     11, -22, 33, 
    //     44, -55, 66,
    //     77, -88, 99,
    // /* Channel = 5 */
    //     /* z = 0 */
    //     11, 11, 0,
    //     11, -20, 41,
    //     21, 11, 20,
    //     /* z = 1 */
    //     21, 11, 10,
    //     11, 41, 10,
    //     11, 10, 11,
    //     /* z = 2 */
    //     11, 10, 21,
    //     11, 21, 10,
    //     11, 11, 10,
    //     /* z = 3*/
    //     5, 10, -15,
    //     20, -25, 30, 
    //     -35, 40, 45,
    //     /* z = 4*/
    //     60, 70, -80,
    //     80, -70, 60,
    //     -70, 80, 60,
    //     /* z = 5*/
    //     11, 22, -33, 
    //     44, -55, 66,
    //     -77, 88, 99
    // };
    // int32_t bias_data[6] = {
    //     20, 31, 42, 54, -15, 67
    // };
    // int8_t output_data[3 * 3 * 6];
    /******************/

    /* Test Case 6 */
    int input_dims[]  = {7, 7, 9};
    int filter_dims[] = {3, 3, 9, 9};
    int bias_dims[]   = {9};
    int stride_width  = 2;
    int stride_height = 2;
    int output_dims[] = {3, 3, 9};

    int8_t input_data[7 * 7 * 9] = {
        /* z = 0 */
            1, 2, 7, 8, -1, -78, 12,
            5, 45, 64, 123, -89, -74, 12,
            7, 45, 123, 45, 90, 101, 87,
            1, 2, 7, 8, -1, 0, -19,
            5, 45, 64, 123, -34, -20, 75,
            7, 45, 123, 45, 90, 101, 96,
            15, 16, 17, 18, 19, 20, 21,
        /* z = 1 */
            -90, 2, 7, 8, -55, -21, 10,
            51, 45, 64, 123, 34, -20, 10,
            57, 45, 123, 45, 90, 101, 21,
            110, 2, 7, 8, -55, -11, 22,
            51, 45, 64, 23, -24, 20, 88,
            71, 45, -23, 45, 90, 101, 66,
            15, 16, 17, 18, 19, 20, 21,
        /* z = 2 */
            1, 23, 7, 8, 55, 21, 10,
            5, 4, 64, 123, 34, 20, 21,
            7, 5, 123, 45, 90, 101, 21,
            1, 2, 7, 8, 55, -1, 18,
            5, 5, 64, 13, 34, 20, 21,
            15, 16, 17, 18, 19, 20, 21,
            23, 24, 25, 26, 27, 28, 29,
        /* z = 3*/
            23, 34, 56, 12, 14, -17, -19,
            20, 21, 127, -128, 110, 103, 19,
            1, 1, 1, 2, 2, 2, 3,
            45, 54, 46, 64, 75, 74, 10,
            1, 23, 7, 8, 55, 21, 10,
            5, 4, 64, 123, 34, 20, 21,
            7, 5, 123, 45, 90, 101, 21,
        /* z = 4*/
            5, 5, 64, 13, 34, 20, 21,
            15, 16, 17, 18, 19, 20, 21,
            23, 24, 25, 26, 27, 28, 29,
            1, 1, 1, 2, 2, 2, 3,
            45, 54, 46, 64, 75, 74, 10,
            1, 23, 7, 8, 55, 21, 10,
            1, 23, 7, 8, 55, 21, 10,
        /* z = 5*/
            -90, 2, 7, 8, -55, -21, 10,
            -90, 2, 7, 8, -55, -21, 10,
            -90, 2, 7, 8, -55, -21, 10,
            1, 2, 7, 8, 55, -1, 18,
            7, 45, 123, 45, 90, 101, 87,
            20, 21, 127, -128, 110, 103, 19,
            23, 34, 56, 12, 14, -17, -19,
        /* z = 6*/
            23, 34, 56, 12, 14, -17, -19,
            20, 21, 127, -128, 110, 103, 19,
            1, 1, 1, 2, 2, 2, 3,
            45, 54, 46, 64, 75, 74, 10,
            1, 23, 7, 8, 55, 21, 10,
            5, 4, 64, 123, 34, 20, 21,
            7, 5, 123, 45, 90, 101, 21,
        /* z = 7*/
            5, 5, 64, 13, 34, 20, 21,
            15, 16, 17, 18, 19, 20, 21,
            23, 24, 25, 26, 27, 28, 29,
            1, 1, 1, 2, 2, 2, 3,
            45, 54, 46, 64, 75, 74, 10,
            1, 23, 7, 8, 55, 21, 10,
            1, 23, 7, 8, 55, 21, 10,
        /* z = 8*/
            -90, 2, 7, 8, -55, -21, 10,
            -90, 2, 7, 8, -55, -21, 10,
            -90, 2, 7, 8, -55, -21, 10,
            1, 2, 7, 8, 55, -1, 18, 
            7, 45, 123, 45, 90, 101, 87,
            20, 21, 127, -128, 110, 103, 19,
            23, 34, 56, 12, 14, -17, -19
    };
    int8_t filter_data[3 * 3 * 9 * 9] = {
    /* Channel = 0 */
        /* z = 0 */
            10, 11, 0,
            10, 0, 11,
            11, 11, 0,
        /* z = 1 */
            11, 11, 0,
            11, 11, 0,
            11, 0, 11,
        /* z = 2 */
            11, 0, 11,
            11, 11, 0,
            11, 11, 0,
        /* z = 3 */
            22, 33, 44,
            55, 66, 77,
            88, 99, 110,
        /* z = 4 */
            22, 0, 22,
            33, 22, 33,
            44, 33, 22,
        /* z = 5 */
            -1, -2, -3,
            -11, -12, -13,
            -14, -15, -16,
        /* z = 6 */
            11, 11, 0,
            11, 11, 0,
            11, 0, 11,
        /* z = 7 */
            11, 0, 11,
            11, 11, 0,
            11, 11, 0,
        /* z = 8 */
            22, 33, 44,
            55, 66, 77,
            88, 99, 110,
    /* Channel = 1 */
        /* z = 0 */
            11, 21, 0,
            21, 0, 11,
            21, 11, 0,
        /* z = 1 */
            21, 11, 0,
            21, 11, 0,
            21, 0, 11,
        /* z = 2 */
            21, 0, 11,
            21, 11, 0,
            21, 11, 0,
        /* z = 3 */
            5, 10, 15,
            20, 25, 30,
            35, 40, 45,
        /* z = 4 */
            60, 70, 80,
            80, 70, 60,
            70, 80, 60,
        /* z = 5 */
            11, 22, 33,
            44, 55, 66,
            77, 88, 99,
        /* z = 6 */
            11, 11, 0,
            11, 11, 0,
            11, 0, 11,
        /* z = 7 */
            11, 0, 11,
            11, 11, 0,
            11, 11, 0,
        /* z = 8 */
            22, 33, 44,
            55, 66, 77,
            88, 99, 110,
    /* Channel = 2 */
        /* z = 0 */
            11, 31, 0,
            11, 0, 11,
            11, 31, 0,
        /* z = 1 */
            11, 31, 0,
            11, 31, 0,
            11, 0, 11,
        /* z = 2 */
            11, 0, 11,
            11, 31, 0,
            11, 31, 0,
        /* z = 3 */
            -5, 10, 15,
            20, -25, 30,
            35, 40, -45,
        /* z = 4 */
            -60, 70, 80,
            80, -70, 60,
            70, 80, -60,
        /* z = 5 */
            -11, 22, 33,
            44, -55, 66,
            77, 88, -99,
        /* z = 6 */
            11, 31, 0,
            11, 0, 11,
            11, 31, 0,
        /* z = 7 */
            11, 31, 0,
            11, 31, 0,
            11, 0, 11,
        /* z = 8 */
            11, 0, 11,
            11, 31, 0,
            11, 31, 0,
    /* Channel = 3 */
        /* z = 0 */
            11, 11, 40,
            11, 40, 41,
            21, 11, 40,
        /* z = 1 */
            21, 11, 40,
            11, 41, 40,
            11, 40, 11,
        /* z = 2 */
            11, 40, 41,
            11, 21, 40,
            11, 11, 40,
        /* z = 3*/
            -5, 10, 15,
            -20, 25, 30,
            -35, 40, 45,
        /* z = 4*/
            -60, 70, 80,
            -80, 70, 60,
            -70, 80, 60,
        /* z = 5*/
            -11, 22, 33,
            -44, 55, 66,
            -77, 88, 99,
        /* z = 6 */
            11, 11, 0,
            11, 11, 0,
            11, 0, 11,
        /* z = 7 */
            11, 31, 0,
            11, 31, 0,
            11, 0, 11,
        /* z = 8 */
            11, 0, 11,
            11, 31, 0,
            11, 31, 0,
    /* Channel = 4 */
        /* z = 0 */
            11, 11, 30,
            11, 30, 41,
            21, 11, 30,
        /* z = 1 */
            21, 11, 30,
            11, 41, 30,
            11, 30, 11,
        /* z = 2 */
            11, 0, 41,
            11, 21, 30,
            11, 11, 30,
        /* z = 3*/
            5, -10, 15,
            20, -25, 30,
            35, -40, 45,
        /* z = 4*/
            60, -70, 80,
            80, -70, 60,
            70, -80, 60,
        /* z = 5*/
            11, -22, 33,
            44, -55, 66,
            77, -88, 99,
        /* z = 6 */
            11, 11, 0,
            11, 11, 0,
            11, 0, 11,
        /* z = 7 */
            11, 31, 0,
            11, 31, 0,
            11, 0, 11,
        /* z = 8 */
            11, 0, 11,
            11, 31, 0,
            11, 31, 0,
    /* Channel = 5 */
        /* z = 0 */
            11, 11, 0,
            11, -20, 41,
            21, 11, 20,
        /* z = 1 */
            21, 11, 10,
            11, 41, 10,
            11, 10, 11,
        /* z = 2 */
            11, 10, 21,
            11, 21, 10,
            11, 11, 10,
        /* z = 3 */
            5, 10, -15,
            20, -25, 30,
            -35, 40, 45,
        /* z = 4 */
            60, 70, -80,
            80, -70, 60,
            -70, 80, 60,
        /* z = 5 */
            11, 22, -33,
            44, -55, 66,
            -77, 88, 99,
        /* z = 6 */
            -5, 10, 15,
            -20, 25, 30,
            -35, 40, 45,
        /* z = 7 */
            -60, 70, 80,
            -80, 70, 60,
            -70, 80, 60,
        /* z = 8 */
            -11, 22, 33,
            -44, 55, 66,
            -77, 88, 99,
    /* Channel = 6 */
        /* z = 0 */
            1, 2, 3,
            4, 5, 6,
            7, 8, 9,
        /* z = 1 */
            -1, 2, 3,
            -4, 5, 6,
            -7, 8, 9,
        /* z = 2 */
            1, -2, 3,
            4, -5, 6,
            7, -8, 9,
        /* z = 3 */
            1, 2, -3,
            4, 5, -6,
            7, 8, -9,
        /* z = 4 */
            -1, -2, -3,
            4, 5, 6,
            7, 8, 9,
        /* z = 5 */
            1, 2, 3,
            -4, -5, -6,
            7, 8, 9,
        /* z = 6 */
            1, 2, 3,
            4, 5, 6,
            -7, -8, -9,
        /* z = 7 */
            -1, 2, 3,
            4, -5, 6,
            7, 8, -9,
        /* z = 8 */
            1, 2, -3,
            4, -5, 6,
            -7, 8, 9,
    /* Channel = 7 */
        /* z = 0 */
            1, 2, 30,
            4, 5, 6,
            7, 8, 9,
        /* z = 1 */
            -1, 2, 3,
            -4, 5, 6,
            -7, 8, 90,
        /* z = 2 */
            1, -2, 3,
            40, -5, 6,
            7, -8, 9,
        /* z = 3 */
            1, 20, -3,
            4, 5, -6,
            7, 8, -9,
        /* z = 4 */
            -1, -2, -3,
            40, 5, 6,
            7, 8, 90,
        /* z = 5 */
            1, 2, 3,
            -4, -5, -6,
            7, 8, 9,
        /* z = 6 */
            1, 20, 3,
            4, 5, 60,
            -7, -8, -9,
        /* z = 7 */
            -1, 2, 3,
            4, -5, 60,
            7, 8, -9,
        /* z = 8 */
            10, 2, -3,
            4, -5, 6,
            -7, 8, 9,
    /* Channel = 8 */
        /* z = 0 */
            1, 2, 3,
            4, 5, 6,
            7, 8, 9,
        /* z = 1 */
            -1, 2, 3,
            -4, 50, 6,
            -7, 8, 9,
        /* z = 2 */
            1, -2, 3,
            40, -5, 6,
            7, -8, 9,
        /* z = 3 */
            1, 2, -3,
            4, 5, -6,
            7, 8, -9,
        /* z = 4 */
            -1, -2, -3,
            4, 50, 6,
            7, 8, 9,
        /* z = 5 */
            1, 20, 3,
            -4, -5, -6,
            7, 80, 9,
        /* z = 6 */
            1, 20, 3,
            4, 5, 6,
            -7, -8, -90,
        /* z = 7 */
            -10, 2, 3,
            4, -50, 6,
            7, 8, -9,
        /* z = 8 */
            10, 2, -3,
            40, -5, 60,
            -70, 80, 90
    };
    int32_t bias_data[9] = {
        20, 31, 42, 54, -15, 67, 34, 35, 78
    };
    int8_t output_data[3 * 3 * 9];
    /******************/

    Conv3DInt(
        input_data, input_dims, 0,
        filter_data, filter_dims, 0,
        bias_data, bias_dims, 
        stride_width, stride_height,
        0, 0,
        output_data, output_dims, 
        0, 1073742347, 7,
        0, 99999999
    );

    printf("Input Data: \n");
    printArray3DI(input_data, input_dims);
    printf("Filter Data: \n");
    printArray4DI(filter_data, filter_dims);
    printf("Bias Data:\n");
    printArray1DI32(bias_data, bias_dims[0]);
    printf("Output Data:\n");
    // printArray3DI(output_data, output_dims);
    printArray3DIH(output_data, output_dims);

    // Special Print
    // printf("*************\n");
    // printf("SOFTWARE RESULT\n");
    // int length = output_dims[0] * output_dims[1] * output_dims[2];
    // for (int i = 0; i < length; i = i + 4) {
    //     printf("%d %d %d %d\n",
    //         output_data[i], 
    //         (i + 1 < length) ? output_data[i + 1] : 0,
    //         (i + 2 < length) ? output_data[i + 2] : 0,
    //         (i + 3 < length) ? output_data[i + 3] : 0
    //     );
    // }
    // printf("*************\n");
}

// void MaxPoolFloat(
//     const float* input_data, const int* input_dims,
//     int stride_width, int stride_height, 
//     int pad_width   , int pad_height, 
//     int filter_width, int filter_height,
//     float* output_data     , const int* output_dims,
//     float output_activation_min, float output_activation_max
// );

void testMaxPoolFloat() {
    int input_dims[]   = {8, 8, 2};
    int output_dims[]  = {4, 4, 2};
    int stride_width   = 2;
    int filter_width   = 2;
    int stride_height  = 2;
    int filter_height  = 2;

    float input_data[8 * 8 * 2] = {
        /* z = 0 */
        11, 22, 34, 54, 67, 89, 12, 45, 
        22, 14, 44, 32, 18, -90, 0, 11,
        21, 81, -127, -100, -109, 90, 91, 78,
        1, 2, 3, 4, 5, 6, 7, 8,
        10, 0, 0, 1, 7, 90, 23, 89,
        11, 22, 44, 33, 55, 81, 19, 29,
        11, 9, 7, 1, 1, 0, -90, 9,
        21, 11, 21, 41, 15, 53, 38, 89, 
        /* z = 1*/
        11, 22, 34, 54, 67, 89, 12, 45, 
        21, 81, -127, -100, -109, 90, 91, 78,
        10, 0, 0, 1, 7, 90, 23, 89,
        11, 9, 7, 1, 1, 0, -90, 9,
        22, 14, 44, 32, 18, -90, 0, 11,
        1, 2, 3, 4, 5, 6, 7, 8,
        11, 22, 44, 33, 55, 81, 19, 29,
        21, 11, 21, 41, 15, 53, 38, 89
    }; 
    float output_data[4 * 4 * 2];

    MaxPoolFloat(
        input_data, input_dims,
        stride_width, stride_height, 
        0, 0, 
        filter_width, filter_height, 
        0, 9999, 
        output_data, output_dims
    );

    printf("Input Data: \n");
    printArray3DF(input_data, input_dims);
    printf("Output Data:\n");
    printArray3DF(output_data, output_dims);
}

// void MaxPoolInt(
//     const int8_t* input_data, const int* input_dims,
//     int stride_width, int stride_height, 
//     int pad_width, int pad_height, 
//     int filter_width, int filter_height,
//     int32_t output_activation_min, int32_t output_activation_max,
//     int8_t* output_data     , const int* output_dims
// );

void testMaxPoolInt() {
    // /* Test Case 0 */
    // int input_dims[]   = {9, 9, 3};
    // int output_dims[]  = {3, 3, 3};
    // int stride_width   = 3;
    // int filter_width   = 3;
    // int stride_height  = 3;
    // int filter_height  = 3;

    // int8_t input_data[9 * 9 * 3] = {
    //     /* z = 0 */
    //     11, 22, 34, 54, 67, 89, 12, 45, 79,
    //     22, 14, 44, 32, 18, -90, 0, 11, 21,
    //     21, 81, -127, -100, -109, 90, 91, 78, 13,
    //     1, 2, 3, 4, 5, 6, 7, 8, 9,
    //     10, 0, 0, 1, 7, 90, 23, 89, -10,
    //     11, 22, 44, 33, 55, 81, 19, 29, 0,
    //     11, 9, 7, 1, 1, 0, -90, 9, 11,
    //     21, 11, 21, 41, 15, 53, 38, 89, 78,
    //     11, 54, 90, 121, 32, 12, 54, 68, 90, 
    //     /* z = 1 */
    //     11, 22, 34, 54, 67, 89, 12, 45, 12,
    //     21, 81, -127, -100, -109, 90, 91, 78, 49,
    //     10, 0, 0, 1, 7, 90, 23, 89, 87,
    //     11, 9, 7, 1, 1, 0, -90, 9, 0,
    //     22, 14, 44, 32, 18, -90, 0, 11, 90,
    //     1, 2, 3, 4, 5, 6, 7, 8, 10,
    //     11, 22, 44, 33, 55, 81, 19, 29, -10,
    //     21, 11, 21, 41, 15, 53, 38, 89, -20,
    //     21, 3, 4, 5, 9, 10, 11, 12, 13,
    //     /* z = 2 */
    //     10, 0, 0, 1, 7, 90, 23, 89, -10,
    //     11, 22, 44, 33, 55, 81, 19, 29, 0,
    //     11, 9, 7, 1, 1, 0, -90, 9, 11,
    //     21, 11, 21, 41, 15, 53, 38, 89, 78,
    //     11, 54, 90, 121, 32, 12, 54, 68, 90, 
    //     10, 0, 0, 1, 7, 90, 23, 89, 87,
    //     11, 9, 7, 1, 1, 0, -90, 9, 0,
    //     22, 14, 44, 32, 18, -90, 0, 11, 90,
    //     1, 2, 3, 4, 5, 6, 7, 8, 10
    // }; 
    // int8_t output_data[3 * 3 * 3];
    // /******************/

    /* Test Case 1 */
    int input_dims[]   = {7, 7, 3};
    int output_dims[]  = {3, 3, 3};
    int stride_width   = 2;
    int filter_width   = 3;
    int stride_height  = 2;
    int filter_height  = 3;

    int8_t input_data[7 * 7 * 3] = {
        /* z = 0 */
        11, 22, 34, 54, 67, 89, 12,
        22, 14, 44, 32, 18, -90, 0,
        21, 81, -127, -100, -109, 90, 91, 
        1, 2, 3, 4, 5, 6, 7, 
        10, 0, 0, 1, 7, 90, 23, 
        11, 22, 44, 33, 55, 81, 19, 
        11, 9, 7, 1, 1, 0, -90, 
        /* z = 1 */
        11, 22, 34, 54, 67, 89, 12, 
        21, 81, -127, -100, -109, 90, 91,
        10, 0, 0, 1, 7, 90, 23, 
        11, 9, 7, 1, 1, 0, -90, 
        22, 14, 44, 32, 18, -90, 0, 
        1, 2, 3, 4, 5, 6, 7,
        11, 22, 44, 33, 55, 81, 19,
        /* z = 2 */
        10, 0, 0, 1, 7, 90, 23, 
        11, 22, 44, 33, 55, 81, 19,
        11, 9, 7, 1, 1, 0, -90,
        10, 0, 0, 1, 7, 90, 23,
        11, 9, 7, 1, 1, 0, -90,
        22, 14, 44, 32, 18, -90, 0,
        1, 2, 3, 4, 5, 6, 7
    }; 
    int8_t output_data[3 * 3 * 3];
    /******************/


    // /* Test Case 2 */
    // int input_dims[]   = {8, 8, 2};
    // int output_dims[]  = {4, 4, 2};
    // int stride_width   = 2;
    // int filter_width   = 2;
    // int stride_height  = 2;
    // int filter_height  = 2;

    // int8_t input_data[8 * 8 * 2] = {
    //     /* z = 0 */
    //     11, 22, 34, 54, 67, 89, 12, 45, 
    //     22, 14, 44, 32, 18, -90, 0, 11,
    //     21, 81, -127, -100, -109, 90, 91, 78,
    //     1, 2, 3, 4, 5, 6, 7, 8,
    //     10, 0, 0, 1, 7, 90, 23, 89,
    //     11, 22, 44, 33, 55, 81, 19, 29,
    //     11, 9, 7, 1, 1, 0, -90, 9,
    //     21, 11, 21, 41, 15, 53, 38, 89, 
    //     /* z = 1*/
    //     11, 22, 34, 54, 67, 89, 12, 45, 
    //     21, 81, -127, -100, -109, 90, 91, 78,
    //     10, 0, 0, 1, 7, 90, 23, 89,
    //     11, 9, 7, 1, 1, 0, -90, 9,
    //     22, 14, 44, 32, 18, -90, 0, 11,
    //     1, 2, 3, 4, 5, 6, 7, 8,
    //     11, 22, 44, 33, 55, 81, 19, 29,
    //     21, 11, 21, 41, 15, 53, 38, 89
    // }; 
    // int8_t output_data[4 * 4 * 2];
    // /******************/

    MaxPoolInt(
        input_data, input_dims,
        stride_width, stride_height, 
        0, 0, 
        filter_width, filter_height, 
        0, 9999, 
        output_data, output_dims
    );

    printf("Input Data: \n");
    printArray3DI(input_data, input_dims);
    printf("Output Data:\n");
    printArray3DI(output_data, output_dims);

    // Special Print
    printf("*************\n");
    printf("SOFTWARE RESULT\n");
    int length = output_dims[0] * output_dims[1] * output_dims[2];
    for (int i = 0; i < length; i = i + 4) {
        printf("%d %d %d %d\n",
            output_data[i], 
            (i + 1 < length) ? output_data[i + 1] : 0,
            (i + 2 < length) ? output_data[i + 2] : 0,
            (i + 3 < length) ? output_data[i + 3] : 0
        );
    }
    printf("*************\n");
}

int main() {
    // testFullyConnected2DFloat();
    // testFullyConnected2DInt();
    // testConv3DFloat();
    testConv3DInt();
    // testMaxPoolFloat();
    // testMaxPoolInt();
    return 0;
}